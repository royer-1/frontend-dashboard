<div>
   <div class="card">
      <div class="font-semibold text-xl">Predios</div>
      <p-dataview [value]="properties" [layout]="layout">
         <ng-template  #header>
            <div class="flex flex-row justify-between">
               <div>
                  <p-button label="Nuevo" icon="pi pi-plus" severity="secondary" class="mr-2" (onClick)="addProperty()" />
                  <p-dialog header="Nuevo Predio" [(visible)]="visibleAdd" [breakpoints]="{ '960px': '75vw' }" [style]="{ width: '30vw' }" [modal]="true">
                     <app-addproperty (onCancel)="visibleAdd = false" (onSaved)="visibleAdd = false"></app-addproperty>
                  </p-dialog>
                  <p-select
                     [options]="typeProperty" 
                     [(ngModel)]="selectedTypeProperty" 
                     optionLabel="label"
                     optionValue="value"
                     placeholder="Tipo de Predio" 
                     class="w-full md:w-50"
                     (ngModelChange)="filterProperties()"
                  />
               </div>
               <div class="flex justify-end">
                  <p-select-button [(ngModel)]="layout" [options]="options" [allowEmpty]="false">
                     <ng-template #item let-option>
                        <i class="pi " [ngClass]="{ 'pi-table': option === 'grid', 'pi-bars': option === 'list' }"></i>
                     </ng-template>
                  </p-select-button>
               </div>
            </div>
         </ng-template>
         <ng-template #list>
            <div class="flex flex-col">
               <div *ngFor="let item of properties; let i = index">
                  <div class="flex flex-col sm:flex-row sm:items-center p-6 gap-4" [ngClass]="{ 'border-t border-surface': i !== 0 }">
                     <div class="md:w-40 relative">
                        <img class="block xl:block mx-auto rounded w-full" src="{{ item.Imagen }}" [alt]="item.NombrePredio" />
                        <div class="absolute bg-black/70 rounded-border" [style]="{ left: '4px', top: '4px' }">
                           <!-- <p-tag [value]="item.estado" [severity]="getSeverity(item)" ></p-tag> -->
                        </div>
                     </div>
                     <div class="flex flex-col md:flex-row justify-between md:items-center flex-1 gap-6">
                        <div class="flex flex-row md:flex-col justify-between items-start gap-2">
                           <div class="flex flex-col gap-1.5">
                              <div class="text-lg font-medium mt-1"> {{ item.NombrePredio }} </div>
                              <div>
                                 <span class="font-medium text-surface-500 dark:text-surface-400 text-sm">Dimensión: {{ item.AreaPredio }} m²</span><br>
                                 <span class="font-medium text-surface-500 dark:text-surface-400 text-sm">{{ item.Descripcion }}</span>
                              </div>
                              <div class="text-sm font-medium"> {{ item.Direccion }}</div>
                           </div>
                        </div>
                        <div class="flex flex-col md:items-end gap-8">
                           <div class="flex flex-col content-center gap-2 w-44">
                               <p-button label="Alquilar" class="flex-auto whitespace-nowrap" severity="info" styleClass="w-full" (onClick)="rentalsProperty()" outlined></p-button>
                              <p-button label="Ver detalles" class="flex-auto whitespace-nowrap" severity="secondary" styleClass="w-full" (onClick)="detailsProperty(item)" outlined></p-button>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <p-dialog header="Detalles" [(visible)]="visibleDetails" [breakpoints]="{ '960px': '75vw' }" [style]="{ width: '30vw' }" [modal]="true">
                  <app-detailsproperty *ngIf="selectedProperty " [property]="selectedProperty " (onUpdated)="deleteFromList($event)"></app-detailsproperty>
               </p-dialog>
            </div>
         </ng-template>

         <ng-template #grid >
            <div class="grid grid-cols-16 gap-4">
               <div *ngFor="let item of properties; let i = index" class="col-span-12 sm:col-span-6 lg:col-span-4 p-2">
                  <div class="p-6 border border-surface-200 dark:border-surface-700 bg-surface-0 dark:bg-surface-900 rounded flex flex-col">
                     <div class="relative w-full shadow-sm">
                        <img class="rounded w-full" src="{{ item.Imagen }}" [alt]="item.NombrePredio" />
                     </div>
                     <div class="pt-5">
                        <div class="">
                           <div>
                              <div class="text-lg font-medium mt-1">
                                 {{ item.NombrePredio }}
                              </div>
                              <div>
                                 <span class="font-medium text-surface-500 dark:text-surface-400 text-sm">Dimensión: {{ item.AreaPredio }} m²</span>
                              </div>
                              <div>
                                 <span class="font-medium text-surface-500 dark:text-surface-400 text-sm">{{ item.Descripcion }}</span>
                              </div>
                              <!-- <div
                                 class="relative "
                                 [style]="{
                                    top: '10px'
                                 }"
                              >
                                 <p-tag [value]="item.estado" [severity]="getSeverity(item)"></p-tag>
                              </div> -->
                           </div>
                        </div>
                        <div class="flex flex-col gap-3 mt-5">
                           <span class="text-sm font-medium"> {{ item.Direccion }}</span>
                           <div class="flex gap-2">
                              <p-button label="Alquilar" class="flex-auto whitespace-nowrap" severity="info" styleClass="w-full" (onClick)="rentalsProperty()" outlined></p-button>
                              <p-button label="Ver detalles" class="flex-auto whitespace-nowrap" severity="secondary" styleClass="w-full" (onClick)="detailsProperty(item)" outlined></p-button>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <p-dialog header="Detalles" [(visible)]="visibleDetails" [breakpoints]="{ '960px': '75vw' }" [style]="{ width: '30vw' }" [modal]="true">
                  <app-detailsproperty *ngIf="selectedProperty " [property]="selectedProperty " (onUpdated)="updateList($event)" (onUpdated)="deleteFromList($event)"></app-detailsproperty>
               </p-dialog>
            </div>
         </ng-template>
      </p-dataview>
      <p-confirmdialog [style]="{ width: '450px' }" />
   </div>
</div>
